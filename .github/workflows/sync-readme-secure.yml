name: Secure Sync README to SCA-HNUST

on:
  push:
    branches:
      - main  # github.io 默认分支

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch README from github.io
        id: readme
        run: |
          README_CONTENT=$(curl -sL https://raw.githubusercontent.com/SCA-HNUST/SCA-HNUST.github.io/main/README.md | base64)
          echo "content=$README_CONTENT" >> $GITHUB_OUTPUT

      - name: Update README in SCA-HNUST
        uses: octokit/request-action@v3
        with:
          route: PUT /repos/SCA-HNUST/SCA-HNUST/contents/README.md
          token: ${{ secrets.PAT_TOKEN }}
          message: "Securely sync README from github.io"
          content: ${{ steps.readme.outputs.content }}
